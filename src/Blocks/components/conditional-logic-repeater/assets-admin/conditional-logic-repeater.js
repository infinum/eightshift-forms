/**
 * Custom component was used from this repo.
 *
 * @link https://github.com/goranalkovic-infinum/conditional-logic-repeater
 *
 * @author Goran AlkoviÄ‡
 */

export class ConditionalTags {
	constructor(options) {
		this.fieldSelector = options.fieldSelector;
	}

	init = () => {
		const elements = document.querySelectorAll(this.fieldSelector);

		// Loop all forms on the page.
		[...elements].forEach((element) => {

			const id = element.getAttribute('data-id');
			const input = document.querySelector(`#${id}`);

			element.addEventListener('es-conditional-logic-repeater-update', (event) => {
				const {
					enabled,
					behavior,
					logic,
					conditions,
				} = event.detail;

				if (conditions[0].field !== '') {
					const data = [
						behavior,
						logic,
						conditions.map((item) => {
							console.log(item);
							if (item.field !== '') {
								return [
									item.field,
									item.comparison,
									item.value,
								];
							}
						}).filter((e) => e)
					];

					input.value = JSON.stringify(data);
				}

				if (!enabled) {
					input.value = '';
				}
			});
		});
	}
}

export function conditionalLogicRepeaterComponent() {
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function t(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerpolicy&&(o.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?o.credentials="include":c.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(c){if(c.ep)return;c.ep=!0;const o=t(c);fetch(c.href,o)}})();function I(){}function $(n){return n()}function ce(){return Object.create(null)}function B(n){n.forEach($)}function Oe(n){return typeof n=="function"}function Be(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Re(n){return Object.keys(n).length===0}function w(n,e){n.appendChild(e)}function H(n,e,t){n.insertBefore(e,t||null)}function J(n){n.parentNode.removeChild(n)}function j(n){return document.createElement(n)}function z(n){return document.createTextNode(n)}function P(){return z(" ")}function Me(){return z("")}function N(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function O(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Pe(n){return Array.from(n.childNodes)}function se(n,e){n.value=e==null?"":e}function q(n,e){for(let t=0;t<n.options.length;t+=1){const l=n.options[t];if(l.__value===e){l.selected=!0;return}}n.selectedIndex=-1}function G(n){const e=n.querySelector(":checked")||n.options[0];return e&&e.__value}function Ve(n){const e={};for(const t of n)e[t.name]=t.value;return e}let ee;function U(n){ee=n}const F=[],Z=[],W=[],ae=[],Fe=Promise.resolve();let x=!1;function Ie(){x||(x=!0,Fe.then(C))}function V(n){W.push(n)}const Y=new Set;let Q=0;function C(){const n=ee;do{for(;Q<F.length;){const e=F[Q];Q++,U(e),Ue(e.$$)}for(U(null),F.length=0,Q=0;Z.length;)Z.pop()();for(let e=0;e<W.length;e+=1){const t=W[e];Y.has(t)||(Y.add(t),t())}W.length=0}while(F.length);for(;ae.length;)ae.pop()();x=!1,Y.clear(),U(n)}function Ue(n){if(n.fragment!==null){n.update(),B(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(V)}}const Ke=new Set;function Ee(n,e){n&&n.i&&(Ke.delete(n),n.i(e))}function K(n,e){n.d(1),e.delete(n.key)}function D(n,e,t,l,c,o,r,f,g,h,M,m){let v=n.length,d=o.length,p=v;const E={};for(;p--;)E[n[p].key]=p;const _=[],k=new Map,y=new Map;for(p=d;p--;){const i=m(c,o,p),a=t(i);let u=r.get(a);u?l&&u.p(i,e):(u=h(a,i),u.c()),k.set(a,_[p]=u),a in E&&y.set(a,Math.abs(p-E[a]))}const L=new Set,S=new Set;function A(i){Ee(i,1),i.m(f,M),r.set(i.key,i),M=i.first,d--}for(;v&&d;){const i=_[d-1],a=n[v-1],u=i.key,b=a.key;i===a?(M=i.first,v--,d--):k.has(b)?!r.has(u)||L.has(u)?A(i):S.has(b)?v--:y.get(u)>y.get(b)?(S.add(u),A(i)):(L.add(b),v--):(g(a,r),v--)}for(;v--;){const i=n[v];k.has(i.key)||g(i,r)}for(;d;)A(_[d-1]);return _}function De(n,e,t,l){const{fragment:c,on_mount:o,on_destroy:r,after_update:f}=n.$$;c&&c.m(e,t),l||V(()=>{const g=o.map($).filter(Oe);r?r.push(...g):B(g),n.$$.on_mount=[]}),f.forEach(V)}function Ge(n,e){const t=n.$$;t.fragment!==null&&(B(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Qe(n,e){n.$$.dirty[0]===-1&&(F.push(n),Ie(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function We(n,e,t,l,c,o,r,f=[-1]){const g=ee;U(n);const h=n.$$={fragment:null,ctx:null,props:o,update:I,not_equal:c,bound:ce(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(g?g.$$.context:[])),callbacks:ce(),dirty:f,skip_bound:!1,root:e.target||g.$$.root};r&&r(h.root);let M=!1;if(h.ctx=t?t(n,e.props||{},(m,v,...d)=>{const p=d.length?d[0]:v;return h.ctx&&c(h.ctx[m],h.ctx[m]=p)&&(!h.skip_bound&&h.bound[m]&&h.bound[m](p),M&&Qe(n,m)),v}):[],h.update(),M=!0,B(h.before_update),h.fragment=l?l(h.ctx):!1,e.target){if(e.hydrate){const m=Pe(e.target);h.fragment&&h.fragment.l(m),m.forEach(J)}else h.fragment&&h.fragment.c();e.intro&&Ee(n.$$.fragment),De(n,e.target,e.anchor,e.customElement),C()}U(g)}let Se;typeof HTMLElement=="function"&&(Se=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:n}=this.$$;this.$$.on_disconnect=n.map($).filter(Oe);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(n,e,t){this[n]=t}disconnectedCallback(){B(this.$$.on_disconnect)}$destroy(){Ge(this,1),this.$destroy=I}$on(n,e){const t=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return t.push(e),()=>{const l=t.indexOf(e);l!==-1&&t.splice(l,1)}}$set(n){this.$$set&&!Re(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}});function ue(n,e,t){const l=n.slice();return l[35]=e[t],l[36]=e,l[37]=t,l}function fe(n,e,t){const l=n.slice();return l[5]=e[t][0],l[38]=e[t][1],l[40]=t,l}function he(n,e,t){const l=n.slice();return l[41]=e[t],l[40]=t,l}function de(n,e,t){const l=n.slice();return l[5]=e[t][0],l[38]=e[t][1],l[40]=t,l}function _e(n,e,t){const l=n.slice();return l[5]=e[t][0],l[38]=e[t][1],l[40]=t,l}function Xe(n){let e,t,l,c,o,r;return{c(){e=j("label"),t=j("input"),c=z(`
			Use conditional logic`),O(t,"type","checkbox"),O(t,"part",l="use-toggle-checkbox "+(n[0]?"use-toggle-checkbox-enabled":"")),O(e,"part","use-toggle-label")},m(f,g){H(f,e,g),w(e,t),t.checked=n[0],w(e,c),o||(r=[N(t,"change",n[21]),N(t,"change",n[15])],o=!0)},p(f,g){g[0]&1&&l!==(l="use-toggle-checkbox "+(f[0]?"use-toggle-checkbox-enabled":""))&&O(t,"part",l),g[0]&1&&(t.checked=f[0])},d(f){f&&J(e),o=!1,B(r)}}}function ge(n){let e,t,l=[],c=new Map,o,r,f=[],g=new Map,h,M,m=[],v=new Map,d,p,E,_=Object.entries(n[7]);const k=i=>i[40];for(let i=0;i<_.length;i+=1){let a=_e(n,_,i),u=k(a);c.set(u,l[i]=me(u,a))}let y=Object.entries(n[8]);const L=i=>i[40];for(let i=0;i<y.length;i+=1){let a=de(n,y,i),u=L(a);g.set(u,f[i]=pe(u,a))}let S=n[3];const A=i=>i[37];for(let i=0;i<S.length;i+=1){let a=ue(n,S,i),u=A(a);v.set(u,m[i]=we(u,a))}return{c(){e=j("div"),t=j("select");for(let i=0;i<l.length;i+=1)l[i].c();o=z(`
			this field if
			`),r=j("select");for(let i=0;i<f.length;i+=1)f[i].c();h=z(`
			of the following match:`),M=P();for(let i=0;i<m.length;i+=1)m[i].c();d=Me(),O(t,"part","header-behavior-select"),n[1]===void 0&&V(()=>n[22].call(t)),O(r,"part","header-logic-select"),n[2]===void 0&&V(()=>n[23].call(r)),O(e,"class","conditional-logic-repeater__item"),O(e,"part","header")},m(i,a){H(i,e,a),w(e,t);for(let u=0;u<l.length;u+=1)l[u].m(t,null);q(t,n[1]),w(e,o),w(e,r);for(let u=0;u<f.length;u+=1)f[u].m(r,null);q(r,n[2]),w(e,h),H(i,M,a);for(let u=0;u<m.length;u+=1)m[u].m(i,a);H(i,d,a),p||(E=[N(t,"change",n[22]),N(t,"change",n[14]),N(r,"change",n[23]),N(r,"change",n[14])],p=!0)},p(i,a){a[0]&128&&(_=Object.entries(i[7]),l=D(l,a,k,1,i,_,c,t,K,me,null,_e)),a[0]&130&&q(t,i[1]),a[0]&256&&(y=Object.entries(i[8]),f=D(f,a,L,1,i,y,g,r,K,pe,null,de)),a[0]&260&&q(r,i[2]),a[0]&31256&&(S=i[3],m=D(m,a,A,1,i,S,v,d.parentNode,K,we,d,ue))},d(i){i&&J(e);for(let a=0;a<l.length;a+=1)l[a].d();for(let a=0;a<f.length;a+=1)f[a].d();i&&J(M);for(let a=0;a<m.length;a+=1)m[a].d(i);i&&J(d),p=!1,B(E)}}}function me(n,e){let t,l=e[38]+"",c;return{key:n,first:null,c(){t=j("option"),c=z(l),t.__value=e[5],t.value=t.__value,this.first=t},m(o,r){H(o,t,r),w(t,c)},p(o,r){e=o},d(o){o&&J(t)}}}function pe(n,e){let t,l=e[38]+"",c;return{key:n,first:null,c(){t=j("option"),c=z(l),t.__value=e[5],t.value=t.__value,this.first=t},m(o,r){H(o,t,r),w(t,c)},p(o,r){e=o},d(o){o&&J(t)}}}function be(n){let e=[],t=new Map,l,c=n[11];const o=r=>r[40];for(let r=0;r<c.length;r+=1){let f=he(n,c,r),g=o(f);t.set(g,e[r]=ke(g,f))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();l=Me()},m(r,f){for(let g=0;g<e.length;g+=1)e[g].m(r,f);H(r,l,f)},p(r,f){f[0]&2048&&(c=r[11],e=D(e,f,o,1,r,c,t,l.parentNode,K,ke,l,he))},d(r){for(let f=0;f<e.length;f+=1)e[f].d(r);r&&J(l)}}}function ke(n,e){let t,l=e[41].label+"",c;return{key:n,first:null,c(){t=j("option"),c=z(l),t.__value=e[41].value,t.value=t.__value,this.first=t},m(o,r){H(o,t,r),w(t,c)},p(o,r){e=o},d(o){o&&J(t)}}}function ve(n,e){let t,l=e[38]+"",c;return{key:n,first:null,c(){t=j("option"),c=z(l),t.__value=e[5],t.value=t.__value,this.first=t},m(o,r){H(o,t,r),w(t,c)},p(o,r){e=o},d(o){o&&J(t)}}}function ye(n){let e,t,l;function c(){return n[27](n[37])}return{c(){e=j("button"),e.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 10H19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>',O(e,"part","remove-condition-button")},m(o,r){H(o,e,r),t||(l=N(e,"click",c),t=!0)},p(o,r){n=o},d(o){o&&J(e),t=!1,l()}}}function we(n,e){var a;let t,l,c,o,r=[],f=new Map,g,h,M,m,v,d,p,E,_=((a=e[4])==null?void 0:a.length)>0&&be(e);function k(){e[24].call(l,e[36],e[37])}let y=Object.entries(e[9]);const L=u=>u[40];for(let u=0;u<y.length;u+=1){let b=fe(e,y,u),T=L(b);f.set(T,r[u]=ve(T,b))}function S(){e[25].call(o,e[36],e[37])}function A(){e[26].call(h,e[36],e[37])}let i=e[37]>0&&ye(e);return{key:n,first:null,c(){t=j("div"),l=j("select"),_&&_.c(),c=P(),o=j("select");for(let u=0;u<r.length;u+=1)r[u].c();g=P(),h=j("input"),M=P(),m=j("button"),m.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 10H10M19 10H10M10 10V1M10 10V19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>',v=P(),i&&i.c(),d=P(),O(l,"part","item-field-select"),e[35].field===void 0&&V(k),O(o,"part","item-comparison-select"),e[35].comparison===void 0&&V(S),O(h,"type","text"),O(h,"part","item-value-input"),O(m,"part","add-condition-button"),O(t,"class","conditional-logic-repeater__item"),O(t,"part","item"),this.first=t},m(u,b){H(u,t,b),w(t,l),_&&_.m(l,null),q(l,e[35].field),w(t,c),w(t,o);for(let T=0;T<r.length;T+=1)r[T].m(o,null);q(o,e[35].comparison),w(t,g),w(t,h),se(h,e[35].value),w(t,M),w(t,m),w(t,v),i&&i.m(t,null),w(t,d),p||(E=[N(l,"change",k),N(l,"change",e[14]),N(o,"change",S),N(o,"change",e[14]),N(h,"input",A),N(h,"change",e[14]),N(m,"click",e[12])],p=!0)},p(u,b){var T;e=u,((T=e[4])==null?void 0:T.length)>0?_?_.p(e,b):(_=be(e),_.c(),_.m(l,null)):_&&(_.d(1),_=null),b[0]&2056&&q(l,e[35].field),b[0]&512&&(y=Object.entries(e[9]),r=D(r,b,L,1,e,y,f,o,K,ve,null,fe)),b[0]&2056&&q(o,e[35].comparison),b[0]&2056&&h.value!==e[35].value&&se(h,e[35].value),e[37]>0?i?i.p(e,b):(i=ye(e),i.c(),i.m(t,d)):i&&(i.d(1),i=null)},d(u){u&&J(t),_&&_.d();for(let b=0;b<r.length;b+=1)r[b].d();i&&i.d(),p=!1,B(E)}}}function Ye(n){let e,t,l=n[10]&&Xe(n),c=(n[0]||!n[10])&&ge(n);return{c(){e=j("div"),l&&l.c(),t=P(),c&&c.c(),this.c=I,O(e,"class","conditional-logic-repeater"),O(e,"part","container")},m(o,r){H(o,e,r),l&&l.m(e,null),w(e,t),c&&c.m(e,null),n[28](e)},p(o,r){o[10]&&l.p(o,r),o[0]||!o[10]?c?c.p(o,r):(c=ge(o),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},i:I,o:I,d(o){o&&J(e),l&&l.d(),c&&c.d(),n[28](null)}}}function Ze(n,e,t){var ne,le,ie,oe,re;const l=s=>{try{JSON.parse(s)}catch{return!1}return!0};let{behaviors:c=null}=e,{logics:o=null}=e,{comparisons:r=null}=e;const f={show:"Show",hide:"Hide"},g={all:"all",any:"any"},h={is:"is",isn:"is not",gt:"greater than",gte:"greater than or equal",lt:"less than",lte:"less than or equal",c:"contains",sw:"starts with",ew:"ends with"},M=typeof c<"u"&&c!==null&&l(c)?JSON.parse(c):f,m=typeof o<"u"&&o!==null&&l(o)?JSON.parse(o):g,v=typeof r<"u"&&r!==null&&l(r)?JSON.parse(r):h,d={enabled:!0,behavior:Object.keys(M)[0],logic:Object.keys(m)[0],conditions:[{field:"",comparison:Object.keys(v)[0],value:""}]};let{enabled:p=d.enabled}=e,{behavior:E=d.behavior}=e,{logic:_=d.logic}=e,{conditions:k=d.conditions}=e,{fields:y}=e,{toggleable:L=null}=e,{value:S=null}=e,{autoclear:A=null}=e,i;const a=typeof L<"u"&&L!==null,u=a&&typeof A<"u"&&A!==null,b=(y==null?void 0:y.length)>0&&l(y)?JSON.parse(y):"",T=()=>{t(3,k=[...k,{field:"",comparison:"is",value:""}])},te=s=>{t(3,k=k.filter((R,qe)=>qe!==s)),X()},X=()=>{const s={detail:{enabled:p,behavior:E,logic:_,conditions:k},composed:!0};i.dispatchEvent(new CustomEvent("es-conditional-logic-repeater-update",s))},je=()=>{X(),u&&!p&&(t(3,k=d.conditions),t(1,E=d.behavior),t(2,_=d.logic))};if(typeof S<"u"&&S!==null&&l(S)){const s=JSON.parse(S);!Array.isArray(s)&&((ne=Object.keys(s))==null?void 0:ne.length)>=1&&(p=(le=s==null?void 0:s.enabled)!=null?le:d.enabled,E=(ie=s==null?void 0:s.behavior)!=null?ie:d.behavior,_=(oe=s==null?void 0:s.logic)!=null?oe:d.logic,k=(re=s==null?void 0:s.conditions)!=null?re:d.conditions)}function Ce(){p=this.checked,t(0,p)}function Ne(){E=G(this),t(1,E),t(7,M)}function Le(){_=G(this),t(2,_),t(8,m)}function Ae(s,R){s[R].field=G(this),t(3,k),t(11,b)}function He(s,R){s[R].comparison=G(this),t(3,k),t(11,b)}function Je(s,R){s[R].value=this.value,t(3,k),t(11,b)}const Te=s=>te(s);function ze(s){Z[s?"unshift":"push"](()=>{i=s,t(6,i)})}return n.$$set=s=>{"behaviors"in s&&t(16,c=s.behaviors),"logics"in s&&t(17,o=s.logics),"comparisons"in s&&t(18,r=s.comparisons),"enabled"in s&&t(0,p=s.enabled),"behavior"in s&&t(1,E=s.behavior),"logic"in s&&t(2,_=s.logic),"conditions"in s&&t(3,k=s.conditions),"fields"in s&&t(4,y=s.fields),"toggleable"in s&&t(19,L=s.toggleable),"value"in s&&t(5,S=s.value),"autoclear"in s&&t(20,A=s.autoclear)},[p,E,_,k,y,S,i,M,m,v,a,b,T,te,X,je,c,o,r,L,A,Ce,Ne,Le,Ae,He,Je,Te,ze]}class xe extends Se{constructor(e){super(),this.shadowRoot.innerHTML='<style>.conditional-logic-repeater{--rptr-font-family:system-ui, sans-serif;--rptr-accent-color:var(--es-conditional-logic-repeater-accent, #29a3a3);--rptr-input-border-color:var(--es-conditional-logic-repeater-input-border, #8f9c9c);--rptr-font-size:var(--es-conditional-logic-repeater-font-size, 0.9em);font-family:system-ui, sans-serif;font-size:var(--rptr-font-size);display:flex;flex-direction:column;gap:1rem}.conditional-logic-repeater,.conditional-logic-repeater *{box-sizing:border-box}button{padding:0.25rem;border:0;margin:0;width:1.75rem;height:1.75rem;background-color:transparent;color:var(--rptr-accent-color);border:1px solid var(--rptr-accent-color);border-radius:100rem;display:flex;align-items:center;justify-content:center;cursor:pointer}button svg{width:1rem;height:1rem}input[type="checkbox"]{width:1.25rem;height:1.25rem;accent-color:var(--rptr-accent-color)}input[type="text"],select{height:2.5rem;border-radius:0.25rem;border:1px solid var(--rptr-input-border-color);padding:0.5rem;outline-color:var(--es-conditional-logic-repeater-accent);accent-color:var(--es-conditional-logic-repeater-accent)}label,.conditional-logic-repeater__item{display:flex;align-items:center;line-height:1}label{gap:0.25rem}.conditional-logic-repeater__item{gap:0.75rem}</style>',We(this,{target:this.shadowRoot,props:Ve(this.attributes),customElement:!0},Ze,Ye,Be,{behaviors:16,logics:17,comparisons:18,enabled:0,behavior:1,logic:2,conditions:3,fields:4,toggleable:19,value:5,autoclear:20},null,[-1,-1]),e&&(e.target&&H(e.target,this,e.anchor),e.props&&(this.$set(e.props),C()))}static get observedAttributes(){return["behaviors","logics","comparisons","enabled","behavior","logic","conditions","fields","toggleable","value","autoclear"]}get behaviors(){return this.$$.ctx[16]}set behaviors(e){this.$$set({behaviors:e}),C()}get logics(){return this.$$.ctx[17]}set logics(e){this.$$set({logics:e}),C()}get comparisons(){return this.$$.ctx[18]}set comparisons(e){this.$$set({comparisons:e}),C()}get enabled(){return this.$$.ctx[0]}set enabled(e){this.$$set({enabled:e}),C()}get behavior(){return this.$$.ctx[1]}set behavior(e){this.$$set({behavior:e}),C()}get logic(){return this.$$.ctx[2]}set logic(e){this.$$set({logic:e}),C()}get conditions(){return this.$$.ctx[3]}set conditions(e){this.$$set({conditions:e}),C()}get fields(){return this.$$.ctx[4]}set fields(e){this.$$set({fields:e}),C()}get toggleable(){return this.$$.ctx[19]}set toggleable(e){this.$$set({toggleable:e}),C()}get value(){return this.$$.ctx[5]}set value(e){this.$$set({value:e}),C()}get autoclear(){return this.$$.ctx[20]}set autoclear(e){this.$$set({autoclear:e}),C()}}customElements.define("conditional-logic-repeater",xe);
}
